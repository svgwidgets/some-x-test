export const useEditorStore = defineStore('editor', () => {
  // Existing state
  const mode = ref<EditorMode>('edit');
  const selectedComponentId = ref<string | null>(null);
  const selectedConnectionId = ref<string | null>(null); // NEW
  const isDrawingConnection = ref(false);
  const showGrid = ref(true);
  // ... rest of state
  
  // Getters
  const isEditMode = computed(() => mode.value === 'edit');
  const isRuntimeMode = computed(() => mode.value === 'runtime');
  const hasSelection = computed(() => 
    selectedComponentId.value !== null || selectedConnectionId.value !== null
  );
  
  // Actions
  function selectComponent(componentId: string | null) {
    selectedComponentId.value = componentId;
    selectedConnectionId.value = null; // Clear connection selection
    console.log(`[Editor] Component selected: ${componentId}`);
  }
  
  function selectConnection(connectionId: string | null) {
    selectedConnectionId.value = connectionId;
    selectedComponentId.value = null; // Clear component selection
    console.log(`[Editor] Connection selected: ${connectionId}`);
  }
  
  function clearSelection() {
    selectedComponentId.value = null;
    console.log('[Editor] Component selection cleared');
  }
  
  function clearConnectionSelection() {
    selectedConnectionId.value = null;
    console.log('[Editor] Connection selection cleared');
  }
  
  function clearAllSelections() {
    selectedComponentId.value = null;
    selectedConnectionId.value = null;
    console.log('[Editor] All selections cleared');
  }
  
  // Update reset
  function reset() {
    mode.value = 'edit';
    selectedComponentId.value = null;
    selectedConnectionId.value = null;
    // ... rest of reset
  }
  
  return {
    // State
    selectedComponentId,
    selectedConnectionId,
    // ... rest
    
    // Actions
    selectComponent,
    selectConnection,
    clearSelection,
    clearConnectionSelection,
    clearAllSelections,
    // ... rest
  };
});
